{"version":3,"sources":["server.js"],"names":["express","require","mysql","app","cors","port","use","origin","json","db","createConnection","host","user","password","database","connect","err","console","error","stack","log","get","req","res","table","params","query","results","status","id","length","post","name","body","result","insertId","put","affectedRows","delete","send","tableName","productName","Ncomplementos","tables","map","row","Object","values","updatedData","message","listen"],"mappings":"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","sourcesContent":["const express = require(\"express\");\r\nconst mysql = require(\"mysql2\");\r\nconst app = express();\r\nconst cors = require(\"cors\");\r\nconst port = 3000;\r\n\r\n// Configurar CORS\r\napp.use(\r\n  cors({\r\n     origin: 'http://localhost:8100'\r\n   // origin: \"http://192.168.1.41:4200\",\r\n  })\r\n);\r\n\r\napp.use(express.json()); // Permite parsear JSON en las solicitudes\r\n\r\n// Configuración de la base de datos\r\nconst db = mysql.createConnection({\r\n  host: \"localhost\",\r\n  user: \"root\",\r\n  password: \"root\",\r\n  database: \"DreamsApp\",\r\n});\r\n\r\n// Conectar a la base de datos\r\ndb.connect((err) => {\r\n  if (err) {\r\n    console.error(\"Error al conectar a la base de datos:\", err.stack);\r\n    return;\r\n  }\r\n  console.log(\"Conectado a la base de datos MySQL.\");\r\n});\r\n\r\n// Ruta para obtener todos los datos de una tabla específica\r\napp.get(\"/api/data/:table\", (req, res) => {\r\n  const { table } = req.params;\r\n  db.query(`SELECT * FROM ??`, [table], (err, results) => {\r\n    if (err) {\r\n      res.status(500).json({ error: \"Error al ejecutar la consulta\" });\r\n      return;\r\n    }\r\n    res.json(results);\r\n  });\r\n});\r\n\r\n// Ruta para obtener un dato específico por ID de una tabla específica\r\napp.get(\"/api/data/:table/:id\", (req, res) => {\r\n  const { table, id } = req.params;\r\n  db.query(`SELECT * FROM ?? WHERE id = ?`, [table, id], (err, results) => {\r\n    if (err) {\r\n      res.status(500).json({ error: \"Error al ejecutar la consulta\" });\r\n      return;\r\n    }\r\n    if (results.length === 0) {\r\n      res.status(404).json({ error: \"Dato no encontrado\" });\r\n      return;\r\n    }\r\n    res.json(results[0]);\r\n  });\r\n});\r\n\r\n// Ruta para insertar datos en una tabla específica\r\napp.post(\"/api/data/:table\", (req, res) => {\r\n  const { table } = req.params;\r\n  const { name } = req.body;\r\n  if (!name) {\r\n    return res.status(400).json({ error: \"El campo name es requerido\" });\r\n  }\r\n\r\n  db.query(\r\n    `INSERT INTO ?? (nombre) VALUES (?)`,\r\n    [table, name],\r\n    (err, result) => {\r\n      if (err) {\r\n        res.status(500).json({ error: \"Error al insertar datos\" });\r\n        return;\r\n      }\r\n      res.status(201).json({ id: result.insertId, name });\r\n    }\r\n  );\r\n});\r\n\r\n// Ruta para actualizar datos en una tabla específica\r\napp.put(\"/api/data/:table/:id\", (req, res) => {\r\n  const { table, id } = req.params;\r\n  const { name } = req.body;\r\n  if (!name) {\r\n    return res.status(400).json({ error: \"El campo name es requerido\" });\r\n  }\r\n\r\n  db.query(\r\n    `UPDATE ?? SET nombre = ? WHERE id = ?`,\r\n    [table, name, id],\r\n    (err, result) => {\r\n      if (err) {\r\n        res.status(500).json({ error: \"Error al actualizar datos\" });\r\n        return;\r\n      }\r\n      if (result.affectedRows === 0) {\r\n        res.status(404).json({ error: \"Dato no encontrado\" });\r\n        return;\r\n      }\r\n      res.json({ id, name });\r\n    }\r\n  );\r\n});\r\n\r\n// Ruta para eliminar datos en una tabla específica\r\napp.delete(\"/api/data/:table/:id\", (req, res) => {\r\n  const { table, id } = req.params;\r\n  db.query(`DELETE FROM ?? WHERE id = ?`, [table, id], (err, result) => {\r\n    if (err) {\r\n      res.status(500).json({ error: \"Error al eliminar datos\" });\r\n      return;\r\n    }\r\n    if (result.affectedRows === 0) {\r\n      res.status(404).json({ error: \"Dato no encontrado\" });\r\n      return;\r\n    }\r\n    res.status(204).send();\r\n  });\r\n});\r\n\r\n// Ruta para obtener complementos de una tabla específica\r\napp.get(\"/api/complementos\", (req, res) => {\r\n  const { table } = req.query;\r\n  if (!table) {\r\n    return res.status(400).json({ error: \"El parámetro 'table' es requerido\" });\r\n  }\r\n\r\n  let query = '';\r\n  if (table === 'Cubatas') {\r\n    query = 'SELECT * FROM Complementos_Cubata'; // Ajusta esto según tu esquema de base de datos\r\n  } else if (table === 'Helados Personalizados') {\r\n    query = 'SELECT * FROM Complementos_Helado'; // Ajusta esto según tu esquema de base de datos\r\n  } else if (table === 'Cafes') {\r\n    query = `SELECT Nombre,Precio FROM Complementos_Cafe `;\r\n  } else if (table === 'Bolleria') {\r\n    query = `SELECT Nombre,Precio FROM Complementos_Bolleria `;\r\n  }\r\n\r\n  db.query(query, [table], (err, results) => {\r\n    if (err) {\r\n      res.status(500).json({ error: \"Error al ejecutar la consulta\" });\r\n      return;\r\n    }\r\n    res.json(results);\r\n  });\r\n});\r\napp.get(\"/api/productos/:tableName/:productName/ncomplementos\", (req, res) => {\r\n  const { tableName, productName } = req.params;\r\n\r\n  // Consulta SQL para obtener Ncomplementos de la tabla especificada\r\n  const query = `SELECT Ncomplementos FROM ?? WHERE Nombre = ?`;\r\n\r\n  // Ejecutar la consulta\r\n  db.query(query, [tableName, productName], (err, results) => {\r\n      if (err) {\r\n          console.error('Error al ejecutar la consulta:', err);\r\n          res.status(500).json({ error: \"Error al ejecutar la consulta\" });\r\n          return;\r\n      }\r\n      if (results.length === 0) {\r\n          res.status(404).json({ error: \"Producto no encontrado\" });\r\n          return;\r\n      }\r\n      res.json({ Ncomplementos: results[0].Ncomplementos });\r\n  });\r\n});\r\n\r\n\r\n\r\n\r\n\r\n// Página de administrador\r\n\r\n// Ruta para obtener los nombres de las tablas\r\napp.get('/api/tables', (req, res) => {\r\n  db.query('SHOW TABLES', (err, results) => {\r\n    if (err) {\r\n      res.status(500).json({ error: 'Error al obtener las tablas' });\r\n      return;\r\n    }\r\n    const tables = results.map(row => Object.values(row)[0]);\r\n    res.json(tables);\r\n  });\r\n});\r\n\r\n// Ruta para obtener datos de una tabla específica\r\napp.get('/api/tables/:tableName', (req, res) => {\r\n  const tableName = req.params.tableName;\r\n  db.query(`SELECT * FROM ??`, [tableName], (err, results) => {\r\n    if (err) {\r\n      res.status(500).json({ error: 'Error al obtener los datos de la tabla' });\r\n      return;\r\n    }\r\n    res.json(results);\r\n  });\r\n});\r\n\r\n// Ruta para editar datos en una tabla específica\r\napp.put('/api/tables/:tableName/:id', (req, res) => {\r\n  const tableName = req.params.tableName;\r\n  const id = req.params.id;\r\n  const updatedData = req.body;\r\n\r\n  db.query(`UPDATE ?? SET ? WHERE id = ?`, [tableName, updatedData, id], (err, result) => {\r\n    if (err) {\r\n      res.status(500).json({ error: 'Error al actualizar los datos' });\r\n      return;\r\n    }\r\n    res.json({ message: 'Datos actualizados correctamente' });\r\n  });\r\n});\r\n// Iniciar el servidor\r\napp.listen(port, () => {\r\n  console.log(`Servidor corriendo en http://localhost:${port}`);\r\n});\r\n"],"file":"server.dev.js"}